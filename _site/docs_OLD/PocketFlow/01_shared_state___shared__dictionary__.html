<h1 id="chapter-1-shared-state-shared-dictionary">Chapter 1: Shared State (<code class="language-plaintext highlighter-rouge">shared</code> dictionary)</h1>

<p>Welcome to your first step into the world of PocketFlow! Building powerful AI applications often involves breaking down complex tasks into smaller, manageable steps. But how do these steps communicate with each other? How does one part of your AI know what another part has done or figured out? That’s where the <strong><code class="language-plaintext highlighter-rouge">shared</code> dictionary</strong> comes into play.</p>

<p>Imagine you’re building a simple AI assistant.</p>
<ol>
  <li>First, it needs to get your question (e.g., “What’s the weather like in London?”).</li>
  <li>Then, it might need to search the web for “weather in London.”</li>
  <li>Finally, it uses your original question and the search results to give you an answer.</li>
</ol>

<p>For this to work, the “question understanding” step needs to pass the question to the “web searching” step. Then, both the original question and the search results need to be available to the “answering” step. The <code class="language-plaintext highlighter-rouge">shared</code> dictionary is the magic message board that lets all these steps share information.</p>

<h2 id="what-is-the-shared-dictionary">What is the <code class="language-plaintext highlighter-rouge">shared</code> Dictionary?</h2>

<p>At its heart, the <code class="language-plaintext highlighter-rouge">shared</code> dictionary is a standard Python dictionary (<code class="language-plaintext highlighter-rouge">dict</code>). Think of it like a <strong>communal backpack</strong> or a <strong>shared whiteboard</strong>.
As your PocketFlow application (which we call a <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>) runs, different components (which we call <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>) can:</p>
<ul>
  <li><strong>Put things into it</strong> (write data).</li>
  <li><strong>Look at what’s inside</strong> (read data).</li>
  <li><strong>Update things</strong> that are already there.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">shared</code> dictionary becomes the primary way for different parts of your workflow to pass data, intermediate results, and context to each other. It’s available throughout the entire lifecycle of a single execution of a <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>.</p>

<h2 id="how-to-use-the-shared-dictionary">How to Use the <code class="language-plaintext highlighter-rouge">shared</code> Dictionary</h2>

<p>Let’s see how this works with a few simple examples.</p>

<p><strong>1. Initializing <code class="language-plaintext highlighter-rouge">shared</code> with Starting Data</strong></p>

<p>Before your <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> even starts, you usually prepare some initial data. This data is placed into the <code class="language-plaintext highlighter-rouge">shared</code> dictionary.</p>

<p>Consider this snippet from one of our example projects (<code class="language-plaintext highlighter-rouge">cookbook/pocketflow-node/main.py</code>):</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is how we can start with some data
</span><span class="n">text_to_summarize</span> <span class="o">=</span> <span class="s">"""
PocketFlow is a minimalist LLM framework...
"""</span>
<span class="n">shared</span> <span class="o">=</span> <span class="p">{</span><span class="s">"data"</span><span class="p">:</span> <span class="n">text_to_summarize</span><span class="p">}</span>

<span class="c1"># Later, this 'shared' dictionary is passed when running the flow:
# flow.run(shared)
</span></code></pre></div></div>
<p>In this code:</p>
<ul>
  <li>We have some <code class="language-plaintext highlighter-rouge">text_to_summarize</code>.</li>
  <li>We create a Python dictionary named <code class="language-plaintext highlighter-rouge">shared</code>.</li>
  <li>We add an entry to this dictionary: the key is <code class="language-plaintext highlighter-rouge">"data"</code> and its value is our <code class="language-plaintext highlighter-rouge">text_to_summarize</code>.
When the <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> starts, this <code class="language-plaintext highlighter-rouge">shared</code> dictionary will be its starting point.</li>
</ul>

<p>Here’s another example from <code class="language-plaintext highlighter-rouge">cookbook/pocketflow-a2a/main.py</code> where a question is put into <code class="language-plaintext highlighter-rouge">shared</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Default question or one from command line
</span><span class="n">question</span> <span class="o">=</span> <span class="s">"Who won the Nobel Prize in Physics 2024?"</span>

<span class="c1"># Process the question
</span><span class="n">shared</span> <span class="o">=</span> <span class="p">{</span><span class="s">"question"</span><span class="p">:</span> <span class="n">question</span><span class="p">}</span>
<span class="c1"># agent_flow.run(shared)
</span></code></pre></div></div>
<p>Here, the <code class="language-plaintext highlighter-rouge">shared</code> dictionary is initialized with the <code class="language-plaintext highlighter-rouge">question</code> under the key <code class="language-plaintext highlighter-rouge">"question"</code>.</p>

<p><strong>2. A <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> Reading from <code class="language-plaintext highlighter-rouge">shared</code></strong></p>

<p><a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> are the workers in your <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>. They often need to read data from the <code class="language-plaintext highlighter-rouge">shared</code> dictionary to know what to do. This usually happens in a Node’s <code class="language-plaintext highlighter-rouge">prep</code> method.</p>

<p>Let’s look at the <code class="language-plaintext highlighter-rouge">Summarize</code> <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> from <code class="language-plaintext highlighter-rouge">cookbook/pocketflow-node/flow.py</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Inside the Summarize Node class
# def prep(self, shared):
#     """Read and preprocess data from shared store."""
#     return shared["data"] # Accesses the 'data' we set earlier
</span></code></pre></div></div>
<p>When this <code class="language-plaintext highlighter-rouge">Summarize</code> <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> is about to run, its <code class="language-plaintext highlighter-rouge">prep</code> method is called. PocketFlow automatically passes the current <code class="language-plaintext highlighter-rouge">shared</code> dictionary to this method.
The line <code class="language-plaintext highlighter-rouge">shared["data"]</code> retrieves the value associated with the key <code class="language-plaintext highlighter-rouge">"data"</code> – which is the text we want to summarize.</p>

<p>Another example from <code class="language-plaintext highlighter-rouge">cookbook/pocketflow-a2a/nodes.py</code>, in the <code class="language-plaintext highlighter-rouge">DecideAction</code> <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Inside the DecideAction Node's prep method
# def prep(self, shared):
# Get the current context (default if none exists)
</span><span class="n">context</span> <span class="o">=</span> <span class="n">shared</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"context"</span><span class="p">,</span> <span class="s">"No previous search"</span><span class="p">)</span>
<span class="c1"># Get the question from the shared store
</span><span class="n">question</span> <span class="o">=</span> <span class="n">shared</span><span class="p">[</span><span class="s">"question"</span><span class="p">]</span>
<span class="k">return</span> <span class="n">question</span><span class="p">,</span> <span class="n">context</span>
</code></pre></div></div>
<p>This <code class="language-plaintext highlighter-rouge">prep</code> method reads two items:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">shared.get("context", "No previous search")</code>: This tries to get the value for the key <code class="language-plaintext highlighter-rouge">"context"</code>. If <code class="language-plaintext highlighter-rouge">"context"</code> isn’t found (maybe it’s the first time this runs), it defaults to <code class="language-plaintext highlighter-rouge">"No previous search"</code>. Using <code class="language-plaintext highlighter-rouge">.get()</code> is a safe way to read, as it prevents errors if a key might be missing.</li>
  <li><code class="language-plaintext highlighter-rouge">shared["question"]</code>: This directly retrieves the value for the key <code class="language-plaintext highlighter-rouge">"question"</code>, assuming it will always be there.</li>
</ul>

<p><strong>3. A <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> Writing Results Back to <code class="language-plaintext highlighter-rouge">shared</code></strong></p>

<p>After a <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> does its work (e.g., summarizes text, gets search results), it often needs to save its findings back into the <code class="language-plaintext highlighter-rouge">shared</code> dictionary. This typically happens in a Node’s <code class="language-plaintext highlighter-rouge">post</code> method.</p>

<p>Continuing with our <code class="language-plaintext highlighter-rouge">Summarize</code> <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> (<code class="language-plaintext highlighter-rouge">cookbook/pocketflow-node/flow.py</code>):</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Inside the Summarize Node class
# 'exec_res' below is the result from the Node's main task
# def post(self, shared, prep_res, exec_res):
#     """Store the summary in shared store."""
#     shared["summary"] = exec_res # Stores the result
</span></code></pre></div></div>
<p>Here, <code class="language-plaintext highlighter-rouge">exec_res</code> holds the summary generated by the <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>. The line <code class="language-plaintext highlighter-rouge">shared["summary"] = exec_res</code> creates a new key <code class="language-plaintext highlighter-rouge">"summary"</code> in the <code class="language-plaintext highlighter-rouge">shared</code> dictionary (or updates it if it already exists) and stores the summary there. Now, subsequent <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> can access this summary!</p>

<p>Similarly, in <code class="language-plaintext highlighter-rouge">DecideAction</code>’s <code class="language-plaintext highlighter-rouge">post</code> method (<code class="language-plaintext highlighter-rouge">cookbook/pocketflow-a2a/nodes.py</code>):</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Inside DecideAction Node's post method
# def post(self, shared, prep_res, exec_res):
# 'exec_res' contains the decision made by an LLM
</span><span class="k">if</span> <span class="n">exec_res</span><span class="p">[</span><span class="s">"action"</span><span class="p">]</span> <span class="o">==</span> <span class="s">"search"</span><span class="p">:</span>
    <span class="n">shared</span><span class="p">[</span><span class="s">"search_query"</span><span class="p">]</span> <span class="o">=</span> <span class="n">exec_res</span><span class="p">[</span><span class="s">"search_query"</span><span class="p">]</span>
    <span class="c1"># ...
</span><span class="k">else</span><span class="p">:</span>
    <span class="n">shared</span><span class="p">[</span><span class="s">"context"</span><span class="p">]</span> <span class="o">=</span> <span class="n">exec_res</span><span class="p">[</span><span class="s">"answer"</span><span class="p">]</span>
    <span class="c1"># ...
# ...
</span></code></pre></div></div>
<p>Depending on the <code class="language-plaintext highlighter-rouge">action</code> decided, this <code class="language-plaintext highlighter-rouge">post</code> method writes either a <code class="language-plaintext highlighter-rouge">"search_query"</code> or an updated <code class="language-plaintext highlighter-rouge">"context"</code> (which is the answer) into the <code class="language-plaintext highlighter-rouge">shared</code> dictionary.</p>

<p><strong>4. Modifying Existing Data in <code class="language-plaintext highlighter-rouge">shared</code></strong></p>

<p>Sometimes, a <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> needs to update or add to existing information in <code class="language-plaintext highlighter-rouge">shared</code>. For example, in a chat application, you maintain a history of messages.</p>

<p>From <code class="language-plaintext highlighter-rouge">cookbook/pocketflow-chat/main.py</code>, the <code class="language-plaintext highlighter-rouge">ChatNode</code>’s <code class="language-plaintext highlighter-rouge">prep</code> method does this:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Inside ChatNode's prep method
# def prep(self, shared):
# Initialize messages if this is the first run
</span><span class="k">if</span> <span class="s">"messages"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">shared</span><span class="p">:</span>
    <span class="n">shared</span><span class="p">[</span><span class="s">"messages"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Create an empty list if no history
</span>
<span class="c1"># ... user_input is obtained ...
</span>
<span class="c1"># Add user message to history
</span><span class="n">shared</span><span class="p">[</span><span class="s">"messages"</span><span class="p">].</span><span class="n">append</span><span class="p">({</span><span class="s">"role"</span><span class="p">:</span> <span class="s">"user"</span><span class="p">,</span> <span class="s">"content"</span><span class="p">:</span> <span class="n">user_input</span><span class="p">})</span>
<span class="c1"># ...
</span></code></pre></div></div>
<p>Here:</p>
<ol>
  <li>It checks if <code class="language-plaintext highlighter-rouge">"messages"</code> (our chat history) exists in <code class="language-plaintext highlighter-rouge">shared</code>. If not, it initializes <code class="language-plaintext highlighter-rouge">shared["messages"]</code> as an empty list.</li>
  <li>It then appends the new user message to this list. The <code class="language-plaintext highlighter-rouge">shared["messages"]</code> list grows with each turn of the conversation.</li>
</ol>

<p><strong>5. Accessing Final Results from <code class="language-plaintext highlighter-rouge">shared</code></strong></p>

<p>Once your <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> has completed all its steps, the <code class="language-plaintext highlighter-rouge">shared</code> dictionary will contain the final outputs and any important intermediate data you chose to store. You can then access these results from your main script.</p>

<p>Back to <code class="language-plaintext highlighter-rouge">cookbook/pocketflow-node/main.py</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># After the flow.run(shared) call:
# The 'shared' dictionary now contains the summary
</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Summary:"</span><span class="p">,</span> <span class="n">shared</span><span class="p">[</span><span class="s">"summary"</span><span class="p">])</span>
</code></pre></div></div>
<p>This line simply prints the value associated with the key <code class="language-plaintext highlighter-rouge">"summary"</code> from the <code class="language-plaintext highlighter-rouge">shared</code> dictionary, which was put there by the <code class="language-plaintext highlighter-rouge">Summarize</code> <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>.</p>

<h2 id="key-characteristics-of-shared">Key Characteristics of <code class="language-plaintext highlighter-rouge">shared</code></h2>

<ul>
  <li><strong>It’s a Python Dictionary:</strong> This makes it incredibly flexible and easy to use. If you know how to use dictionaries in Python (e.g., <code class="language-plaintext highlighter-rouge">my_dict['key'] = value</code>, <code class="language-plaintext highlighter-rouge">value = my_dict['key']</code>, <code class="language-plaintext highlighter-rouge">my_dict.get('key', default_value)</code>), you already know how to interact with <code class="language-plaintext highlighter-rouge">shared</code>.</li>
  <li><strong>Scoped to a Single Flow Execution:</strong> Each time you run a <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> (e.g., by calling <code class="language-plaintext highlighter-rouge">flow.run(shared_input)</code>), it operates on its own instance of the <code class="language-plaintext highlighter-rouge">shared</code> dictionary. If you run the same <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> twice, even simultaneously for different requests, they will have completely separate <code class="language-plaintext highlighter-rouge">shared</code> dictionaries. They won’t interfere with each other. Think of it like two people filling out their own copies of the same form.</li>
  <li><strong>Persistent Throughout One Flow Execution:</strong> The <code class="language-plaintext highlighter-rouge">shared</code> dictionary is created (or you provide an initial one) when a <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a> starts. The <em>exact same</em> dictionary object is then passed from one <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> to the next. Any modifications made by one <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> are visible to all subsequent <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>.</li>
</ul>

<h2 id="what-happens-under-the-hood-a-simplified-view">What Happens Under the Hood? (A Simplified View)</h2>

<p>You don’t need to manage the passing of the <code class="language-plaintext highlighter-rouge">shared</code> dictionary yourself; PocketFlow handles it for you. Here’s a simplified step-by-step:</p>

<ol>
  <li><strong>You start a Flow:</strong> You call something like <code class="language-plaintext highlighter-rouge">my_flow.run(initial_shared_data)</code>. <code class="language-plaintext highlighter-rouge">initial_shared_data</code> is the dictionary you’ve prepared.</li>
  <li><strong>PocketFlow takes over:</strong> It takes your <code class="language-plaintext highlighter-rouge">initial_shared_data</code> and passes it to the first <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> in your <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>.</li>
  <li><strong>Node executes:</strong>
    <ul>
      <li>The <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>’s <code class="language-plaintext highlighter-rouge">prep</code> method is called with the <code class="language-plaintext highlighter-rouge">shared</code> dictionary. It can read from it.</li>
      <li>The <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>’s <code class="language-plaintext highlighter-rouge">exec</code> method (the main workhorse) is called.</li>
      <li>The <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>’s <code class="language-plaintext highlighter-rouge">post</code> method is called with the <code class="language-plaintext highlighter-rouge">shared</code> dictionary. It can write results back to it.</li>
    </ul>
  </li>
  <li><strong>Pass it on:</strong> PocketFlow determines the next <a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> to run and passes the <em>same, possibly modified</em>, <code class="language-plaintext highlighter-rouge">shared</code> dictionary to it.</li>
  <li><strong>Repeat:</strong> Steps 3 and 4 repeat until there are no more <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> to run in the <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>.</li>
  <li><strong>Flow ends:</strong> The <code class="language-plaintext highlighter-rouge">run</code> method finishes, and the <code class="language-plaintext highlighter-rouge">shared</code> dictionary you originally passed in now contains all the updates made by the <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>.</li>
</ol>

<p>Here’s a visual way to think about it:</p>

<pre><code class="language-mermaid">sequenceDiagram
    participant You
    participant PocketFlowEngine as PocketFlow Engine
    participant NodeA as First Node
    participant NodeB as Second Node
    participant SharedDict as Shared Dictionary

    You-&gt;&gt;PocketFlowEngine: my_flow.run(initial_shared)
    PocketFlowEngine-&gt;&gt;SharedDict: Initialize with initial_shared
    PocketFlowEngine-&gt;&gt;NodeA: process(SharedDict)
    NodeA-&gt;&gt;SharedDict: Reads input (e.g., shared['question'])
    NodeA-&gt;&gt;SharedDict: Writes output (e.g., shared['data_from_A'] = ...)
    PocketFlowEngine-&gt;&gt;NodeB: process(SharedDict)
    NodeB-&gt;&gt;SharedDict: Reads input (e.g., shared['data_from_A'])
    NodeB-&gt;&gt;SharedDict: Writes output (e.g., shared['final_answer'] = ...)
    PocketFlowEngine-&gt;&gt;You: Flow complete (initial_shared is now updated)
</code></pre>

<h2 id="analogy-time">Analogy Time!</h2>

<p>Think of the <code class="language-plaintext highlighter-rouge">shared</code> dictionary as:</p>

<ul>
  <li><strong>A Relay Race Baton (but smarter!):</strong> Each runner (<a href="02_node___basenode____node____asyncnode___.md">Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>) takes the baton (<code class="language-plaintext highlighter-rouge">shared</code> dictionary), maybe adds a small note or a sticker to it, and then passes it to the next runner. By the end of the race, the baton has collected contributions from everyone.</li>
  <li><strong>A Project’s Shared Folder:</strong> Imagine a team working on a project. They have a shared folder (<code class="language-plaintext highlighter-rouge">shared</code> dictionary) on a server. The first person creates a document (initial data). The next person opens it, adds their part, and saves it. The next person does the same. Everyone works on the same set of files in that folder.</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>You’ve now learned about the <code class="language-plaintext highlighter-rouge">shared</code> dictionary, the backbone of communication within a PocketFlow <a href="04_flow___flow____asyncflow___.md">Flow (<code class="language-plaintext highlighter-rouge">Flow</code>, <code class="language-plaintext highlighter-rouge">AsyncFlow</code>)</a>. It’s a simple yet powerful Python dictionary that allows different <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> to share data and context seamlessly. By reading from and writing to <code class="language-plaintext highlighter-rouge">shared</code>, your <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a> can collaborate to achieve complex tasks.</p>

<p>Now that you understand how data is passed around, you’re probably wondering about the “workers” themselves – the <a href="02_node___basenode____node____asyncnode___.md">Nodes (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a>. What are they, and how do you build them? Let’s dive into that in the next chapter!</p>

<p>Next up: <a href="02_node___basenode____node____asyncnode___.md">Chapter 2: Node (<code class="language-plaintext highlighter-rouge">BaseNode</code>, <code class="language-plaintext highlighter-rouge">Node</code>, <code class="language-plaintext highlighter-rouge">AsyncNode</code>)</a></p>

<hr />

<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a></p>
