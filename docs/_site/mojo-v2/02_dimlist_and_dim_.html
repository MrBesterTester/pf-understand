<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Chapter 2: DimList and Dim | Two Tutorials for Mojo using Pocket Flow</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Chapter 2: DimList and Dim" /> <meta name="author" content="Sam Kirk" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation generated using AI to explain codebases" /> <meta property="og:description" content="Documentation generated using AI to explain codebases" /> <link rel="canonical" href="http://localhost:4000/mojo-v2/02_dimlist_and_dim_.html" /> <meta property="og:url" content="http://localhost:4000/mojo-v2/02_dimlist_and_dim_.html" /> <meta property="og:site_name" content="Two Tutorials for Mojo using Pocket Flow" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Chapter 2: DimList and Dim" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Sam Kirk","url":"https://www.linkedin.com/in/samuelkirk"},"description":"Documentation generated using AI to explain codebases","headline":"Chapter 2: DimList and Dim","url":"http://localhost:4000/mojo-v2/02_dimlist_and_dim_.html"}</script> <!-- End Jekyll SEO tag --> <!-- Add Mermaid support --> <script src="https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js"></script> <script> document.addEventListener("DOMContentLoaded", function() { mermaid.initialize({ startOnLoad: true, theme: "default" }); // Process code blocks document.querySelectorAll('pre code.language-mermaid').forEach(function(block) { // Create a div with class 'mermaid' var mermaidDiv = document.createElement('div'); mermaidDiv.className = 'mermaid'; mermaidDiv.innerHTML = block.textContent; // Replace the parent pre with the mermaid div block.parentNode.parentNode.replaceChild(mermaidDiv, block.parentNode); console.log("Processed Mermaid block:", mermaidDiv.innerHTML.substring(0, 50) + "..."); }); console.log("Mermaid initialization complete. Version:", mermaid.version()); }); </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Two Tutorials for Mojo using Pocket Flow </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">README</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Crawl4AI category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Crawl4AI/" class="nav-list-link">Crawl4AI</a><ul class="nav-list"><li class="nav-list-item "><a href="/Crawl4AI/01_asynccrawlerstrategy.html" class="nav-list-link">AsyncCrawlerStrategy</a></li><li class="nav-list-item "><a href="/Crawl4AI/01_configuration_system_.html" class="nav-list-link">Chapter 1: Configuration System</a></li><li class="nav-list-item "><a href="/Crawl4AI/02_asyncwebcrawler.html" class="nav-list-link">AsyncWebCrawler</a></li><li class="nav-list-item "><a href="/Crawl4AI/02_asyncwebcrawler_.html" class="nav-list-link">Chapter 2: AsyncWebCrawler</a></li><li class="nav-list-item "><a href="/Crawl4AI/03_content_extraction_pipeline_.html" class="nav-list-link">Chapter 3: Content Extraction Pipeline</a></li><li class="nav-list-item "><a href="/Crawl4AI/03_crawlerrunconfig.html" class="nav-list-link">CrawlerRunConfig</a></li><li class="nav-list-item "><a href="/Crawl4AI/04_contentscrapingstrategy.html" class="nav-list-link">ContentScrapingStrategy</a></li><li class="nav-list-item "><a href="/Crawl4AI/04_url_filtering___scoring_.html" class="nav-list-link">Chapter 4: URL Filtering & Scoring</a></li><li class="nav-list-item "><a href="/Crawl4AI/05_deep_crawling_system_.html" class="nav-list-link">Chapter 5: Deep Crawling System</a></li><li class="nav-list-item "><a href="/Crawl4AI/05_relevantcontentfilter.html" class="nav-list-link">RelevantContentFilter</a></li><li class="nav-list-item "><a href="/Crawl4AI/06_caching_system_.html" class="nav-list-link">Chapter 6: Caching System</a></li><li class="nav-list-item "><a href="/Crawl4AI/06_extractionstrategy.html" class="nav-list-link">ExtractionStrategy</a></li><li class="nav-list-item "><a href="/Crawl4AI/07_crawlresult.html" class="nav-list-link">CrawlResult</a></li><li class="nav-list-item "><a href="/Crawl4AI/07_dispatcher_framework_.html" class="nav-list-link">Chapter 7: Dispatcher Framework</a></li><li class="nav-list-item "><a href="/Crawl4AI/08_async_logging_infrastructure_.html" class="nav-list-link">Chapter 8: Async Logging Infrastructure</a></li><li class="nav-list-item "><a href="/Crawl4AI/08_deepcrawlstrategy.html" class="nav-list-link">DeepCrawlStrategy</a></li><li class="nav-list-item "><a href="/Crawl4AI/09_cachecontext___cachemode.html" class="nav-list-link">CacheContext & CacheMode</a></li><li class="nav-list-item "><a href="/Crawl4AI/09_api___docker_integration_.html" class="nav-list-link">Chapter 9: API & Docker Integration</a></li><li class="nav-list-item "><a href="/Crawl4AI/10_basedispatcher.html" class="nav-list-link">BaseDispatcher</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in My Tutorial for Crawl4ai category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/my-crawl4AI/" class="nav-list-link">My Tutorial for Crawl4ai</a><ul class="nav-list"><li class="nav-list-item "><a href="/my-crawl4ai/01_configuration_system_.html" class="nav-list-link">Chapter 1: Configuration System</a></li><li class="nav-list-item "><a href="/my-crawl4ai/02_asyncwebcrawler_.html" class="nav-list-link">Chapter 2: AsyncWebCrawler</a></li><li class="nav-list-item "><a href="/my-crawl4ai/03_content_extraction_pipeline_.html" class="nav-list-link">Chapter 3: Content Extraction Pipeline</a></li><li class="nav-list-item "><a href="/my-crawl4ai/04_url_filtering___scoring_.html" class="nav-list-link">Chapter 4: URL Filtering & Scoring</a></li><li class="nav-list-item "><a href="/my-crawl4ai/05_deep_crawling_system_.html" class="nav-list-link">Chapter 5: Deep Crawling System</a></li><li class="nav-list-item "><a href="/my-crawl4ai/06_caching_system_.html" class="nav-list-link">Chapter 6: Caching System</a></li><li class="nav-list-item "><a href="/my-crawl4ai/07_dispatcher_framework_.html" class="nav-list-link">Chapter 7: Dispatcher Framework</a></li><li class="nav-list-item "><a href="/my-crawl4ai/08_async_logging_infrastructure_.html" class="nav-list-link">Chapter 8: Async Logging Infrastructure</a></li><li class="nav-list-item "><a href="/my-crawl4ai/09_api___docker_integration_.html" class="nav-list-link">Chapter 9: API & Docker Integration</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in My Tutorial for Modular's Max category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/modular_max/" class="nav-list-link">My Tutorial for Modular's Max</a><ul class="nav-list"><li class="nav-list-item "><a href="/modular_max/01_settings___settings__class__.html" class="nav-list-link">Chapter 1: Settings Class</a></li><li class="nav-list-item "><a href="/modular_max/02_serving_api_layer__fastapi_app___routers__.html" class="nav-list-link">Chapter 2: Serving API Layer</a></li><li class="nav-list-item "><a href="/modular_max/03_llm_pipeline_orchestrator___tokengeneratorpipeline___.html" class="nav-list-link">Chapter 3: LLM Pipeline Orchestrator</a></li><li class="nav-list-item "><a href="/modular_max/04_model_worker_.html" class="nav-list-link">Chapter 4: Model Worker</a></li><li class="nav-list-item "><a href="/modular_max/05_scheduler___tokengenerationscheduler____embeddingsscheduler___.html" class="nav-list-link">Chapter 5: Scheduler</a></li><li class="nav-list-item "><a href="/modular_max/06_kv_cache_management_.html" class="nav-list-link">Chapter 6: KV Cache Management</a></li><li class="nav-list-item "><a href="/modular_max/07_enginequeue_.html" class="nav-list-link">Chapter 7: EngineQueue</a></li><li class="nav-list-item "><a href="/modular_max/08_telemetry_and_metrics___metrics____metricclient___.html" class="nav-list-link">Chapter 8: Telemetry and Metrics</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in My Tutorial for Mojo v1 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/mojo-v1/" class="nav-list-link">My Tutorial for Mojo v1</a><ul class="nav-list"><li class="nav-list-item "><a href="/mojo-v1/01_addressspace_.html" class="nav-list-link">Chapter 1: AddressSpace</a></li><li class="nav-list-item "><a href="/mojo-v1/02_unsafepointer_.html" class="nav-list-link">Chapter 2: UnsafePointer</a></li><li class="nav-list-item "><a href="/mojo-v1/03_indexlist_.html" class="nav-list-link">Chapter 3: IndexList</a></li><li class="nav-list-item "><a href="/mojo-v1/04_dimlist_.html" class="nav-list-link">Chapter 4: DimList</a></li><li class="nav-list-item "><a href="/mojo-v1/05_ndbuffer_.html" class="nav-list-link">Chapter 5: NDBuffer</a></li><li class="nav-list-item "><a href="/mojo-v1/06_n_d_to_1d_indexing_logic__strided_memory_access__.html" class="nav-list-link">Chapter 6: N-D to 1D Indexing Logic</a></li></ul></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in My Tutorial for Mojo v2 category" aria-pressed="true"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/mojo-v2/" class="nav-list-link">My Tutorial for Mojo v2</a><ul class="nav-list"><li class="nav-list-item "><a href="/mojo-v2/01_unsafepointer__as_used_by_ndbuffer__.html" class="nav-list-link">Chapter 1: UnsafePointer</a></li><li class="nav-list-item active"><a href="/mojo-v2/02_dimlist_and_dim_.html" class="nav-list-link active">Chapter 2: DimList and Dim</a></li><li class="nav-list-item "><a href="/mojo-v2/03_ndbuffer_.html" class="nav-list-link">Chapter 3: NDBuffer</a></li><li class="nav-list-item "><a href="/mojo-v2/04_strides_and_offset_computation_.html" class="nav-list-link">Chapter 4: Strides and Offset Computation</a></li><li class="nav-list-item "><a href="/mojo-v2/05_simd_data_access_.html" class="nav-list-link">Chapter 5: SIMD Data Access</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Comparisons category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/comparisons/" class="nav-list-link">Comparisons</a><ul class="nav-list"><li class="nav-list-item "><a href="/comparisons/crawl4ai-versions.html" class="nav-list-link">The original version of Crawl4AI vs. the sanity check I did</a></li><li class="nav-list-item "><a href="/comparisons/mojo-versions.html" class="nav-list-link">The 1st version of the Mojo Tutorial vs. The 2nd version of the Mojo Tutorial</a></li></ul></li><li class="nav-list-item"><a href="/generating/" class="nav-list-link">Generating & Preparing for the Mojo Tutorials using Pocket Flow</a></li><li class="nav-list-item"><a href="/design.html" class="nav-list-link">System Design</a></li></ul> <div class="nav-category">Crawl4AI</div> <ul class="nav-list"></ul> <div class="nav-category">Modular Max</div> <ul class="nav-list"></ul> <div class="nav-category">Mojo (v1)</div> <ul class="nav-list"></ul> <div class="nav-category">Mojo (v2)</div> <ul class="nav-list"></ul> <div class="nav-category">Generating</div> <ul class="nav-list"></ul> <div class="nav-category">AI Design</div> <ul class="nav-list"></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Two Tutorials for Mojo using Pocket Flow" aria-label="Search Two Tutorials for Mojo using Pocket Flow" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/MrBesterTester/pf-understand" class="site-button" > View on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/mojo-v2/">My Tutorial for Mojo v2</a></li> <li class="breadcrumb-nav-list-item"><span>Chapter 2: DimList and Dim</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <p>Okay, here’s Chapter 2 of the Mojo tutorial, focusing on <code class="language-plaintext highlighter-rouge">DimList</code> and <code class="language-plaintext highlighter-rouge">Dim</code>, designed to be very beginner-friendly.</p> <h1 id="chapter-2-defining-dimensions---dim-and-dimlist"> <a href="#chapter-2-defining-dimensions---dim-and-dimlist" class="anchor-heading" aria-labelledby="chapter-2-defining-dimensions---dim-and-dimlist"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Chapter 2: Defining Dimensions - <code class="language-plaintext highlighter-rouge">Dim</code> and <code class="language-plaintext highlighter-rouge">DimList</code> </h1> <p>In <a href="01_unsafepointer__as_used_by_ndbuffer__.md">Chapter 1: Meet <code class="language-plaintext highlighter-rouge">UnsafePointer</code></a>, we learned that <code class="language-plaintext highlighter-rouge">NDBuffer</code> uses an <code class="language-plaintext highlighter-rouge">UnsafePointer</code> (its <code class="language-plaintext highlighter-rouge">data</code> field) to know the starting memory address of its data. This tells <code class="language-plaintext highlighter-rouge">NDBuffer</code> <em>where</em> its numbers, pixels, or other elements begin in the computer’s memory.</p> <p>But just knowing <em>where</em> data starts isn’t enough. If you have a block of memory, how do you know if it represents:</p> <ul> <li>A simple list of 10 numbers? (<code class="language-plaintext highlighter-rouge">[1, 2, ..., 10]</code>)</li> <li>A 2x5 grid of numbers? <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, 4, 5
6, 7, 8, 9, 10
</code></pre></div> </div> </li> <li>Or even a 3D cube of data?</li> </ul> <p>To make sense of the raw data pointed to by <code class="language-plaintext highlighter-rouge">UnsafePointer</code>, <code class="language-plaintext highlighter-rouge">NDBuffer</code> needs to understand its <strong>structure</strong> or <strong>shape</strong>. It also needs to know how elements are laid out in memory, which involves something called <strong>strides</strong>. For these crucial pieces of information, Mojo uses two important building blocks: <code class="language-plaintext highlighter-rouge">Dim</code> and <code class="language-plaintext highlighter-rouge">DimList</code>.</p> <p>As the project description states:</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">DimList</code> is a compile-time list that holds dimension-related information, primarily used for an <code class="language-plaintext highlighter-rouge">NDBuffer</code>’s shape and strides. Each element in a <code class="language-plaintext highlighter-rouge">DimList</code> is a <code class="language-plaintext highlighter-rouge">Dim</code>. A <code class="language-plaintext highlighter-rouge">Dim</code> object can represent either a statically known integer value (e.g., a dimension of size 3, known at compile time) or an unknown value (dynamic size) that will only be determined at runtime. This design allows <code class="language-plaintext highlighter-rouge">NDBuffer</code> to be flexible, supporting both fully static and partially or fully dynamic tensor shapes and strides.</p> </blockquote> <p>Let’s break these down.</p> <h2 id="dim-a-single-dimensions-story"> <a href="#dim-a-single-dimensions-story" class="anchor-heading" aria-labelledby="dim-a-single-dimensions-story"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">Dim</code>: A Single Dimension’s Story </h2> <p>Imagine you’re describing one side of a box. That side has a length. A <code class="language-plaintext highlighter-rouge">Dim</code> in Mojo represents the size of a single dimension. This “size” can be:</p> <ol> <li><strong>Statically Known</strong>: The size is a specific, fixed number known when you write your code and when Mojo compiles it. For example, a dimension of size <code class="language-plaintext highlighter-rouge">5</code>.</li> <li><strong>Dynamically Known</strong>: The size isn’t known until your program is actually running. It might depend on user input, a file being read, or calculations done earlier in the program. Mojo uses a special internal marker (a <code class="language-plaintext highlighter-rouge">_sentinel</code> value, which is <code class="language-plaintext highlighter-rouge">-31337</code> in the <code class="language-plaintext highlighter-rouge">stdlib/src/buffer/dimlist.mojo</code> code) to represent this “unknown for now” state.</li> </ol> <p>Think of it like this:</p> <ul> <li><code class="language-plaintext highlighter-rouge">Dim(5)</code> means “This dimension definitely has a size of 5.”</li> <li><code class="language-plaintext highlighter-rouge">Dim()</code> means “The size of this dimension is currently unknown; we’ll find out at runtime.”</li> </ul> <h3 id="creating-and-using-dim"> <a href="#creating-and-using-dim" class="anchor-heading" aria-labelledby="creating-and-using-dim"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating and Using <code class="language-plaintext highlighter-rouge">Dim</code> </h3> <p>Let’s look at how you work with <code class="language-plaintext highlighter-rouge">Dim</code> objects. The code for <code class="language-plaintext highlighter-rouge">Dim</code> can be found in <code class="language-plaintext highlighter-rouge">stdlib/src/buffer/dimlist.mojo</code>.</p><pre><code class="language-mojo">// First, you'd typically import Dim if you're using it directly
// (though often it's used implicitly through DimList and NDBuffer)
// from buffer import Dim // We'll assume this for standalone examples

// Creating Dims
let static_dim = Dim(5)    // A dimension known to be 5 at compile time
let another_static_dim: Dim = 10 // You can also assign integers directly
let dynamic_dim = Dim()    // A dimension whose size is unknown at compile time

// Printing Dims
print("Static Dim:", static_dim)       // Output: Static Dim: 5
print("Dynamic Dim:", dynamic_dim)     // Output: Dynamic Dim: ?

// Checking if a Dim has a static value
if static_dim.has_value():
    print("static_dim has a value.") // This will print
else:
    print("static_dim is dynamic.")

if dynamic_dim.has_value():
    print("dynamic_dim has a value.")
else:
    print("dynamic_dim is dynamic.") // This will print

// You can also use a Dim directly in a boolean context
if static_dim: // This is true if static_dim.has_value() is true
    print("static_dim evaluates to true (it has a value).")

if dynamic_dim:
    print("dynamic_dim evaluates to true.")
else:
    print("dynamic_dim evaluates to false (it's dynamic).")


// Getting the static value
if static_dim:
    print("Value of static_dim:", static_dim.get()) // Output: Value of static_dim: 5

// What if you try to .get() a dynamic dimension?
// print(dynamic_dim.get()) // This would give the internal sentinel value (-31337).
// It's safer to check first, or use or_else:
let dynamic_val_or_default = dynamic_dim.or_else(1) // If dynamic_dim is dynamic, use 1
print("Dynamic value or default:", dynamic_val_or_default) // Output: Dynamic value or default: 1

// Checking if a dimension is dynamic
if dynamic_dim.is_dynamic():
    print("dynamic_dim is indeed dynamic!") // This will print
</code></pre><p><strong>Key <code class="language-plaintext highlighter-rouge">Dim</code> features to remember:</strong></p> <ul> <li><strong>Creation</strong>: <code class="language-plaintext highlighter-rouge">Dim(number)</code> for static, <code class="language-plaintext highlighter-rouge">Dim()</code> for dynamic.</li> <li><strong>Checking</strong>: <code class="language-plaintext highlighter-rouge">has_value()</code> (or just <code class="language-plaintext highlighter-rouge">if my_dim:</code>) tells you if it’s static. <code class="language-plaintext highlighter-rouge">is_dynamic()</code> tells you if it’s dynamic.</li> <li><strong>Getting Value</strong>: <code class="language-plaintext highlighter-rouge">get()</code> retrieves the static value. Be cautious and check <code class="language-plaintext highlighter-rouge">has_value()</code> first, or use <code class="language-plaintext highlighter-rouge">or_else(default_value)</code>.</li> <li><strong>String Representation</strong>: Prints as the number if static, or <code class="language-plaintext highlighter-rouge">?</code> if dynamic.</li> </ul> <p>The <code class="language-plaintext highlighter-rouge">Dim</code> struct (defined with <code class="language-plaintext highlighter-rouge">@value struct Dim(...)</code> in the source code) is designed to be very efficient, especially when its value is known at compile time.</p> <h2 id="dimlist-a-collection-of-dimensions"> <a href="#dimlist-a-collection-of-dimensions" class="anchor-heading" aria-labelledby="dimlist-a-collection-of-dimensions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">DimList</code>: A Collection of Dimensions </h2> <p>Now that we understand a single <code class="language-plaintext highlighter-rouge">Dim</code>, <code class="language-plaintext highlighter-rouge">DimList</code> is straightforward: it’s a list of <code class="language-plaintext highlighter-rouge">Dim</code> objects.</p> <blockquote> <p>Imagine <code class="language-plaintext highlighter-rouge">DimList</code> as the blueprint for the dimensions of a container. Each <code class="language-plaintext highlighter-rouge">Dim</code> in the list specifies a particular dimension’s size, like length, width, or height. Some of these might be fixed values written directly on the blueprint (e.g., “length is 5 units”), while others might be placeholders (e.g., “width is N units, to be measured on-site”). <code class="language-plaintext highlighter-rouge">DimList</code> collects all these specifications.</p> </blockquote> <p>For an <code class="language-plaintext highlighter-rouge">NDBuffer</code>, <code class="language-plaintext highlighter-rouge">DimList</code> is used for two main things:</p> <ol> <li><strong>Shape</strong>: Describes the size of the <code class="language-plaintext highlighter-rouge">NDBuffer</code> in each dimension (e.g., number of rows, number of columns, number of channels).</li> <li><strong>Strides</strong>: Describes how many elements you need to “skip” in memory to move from one element to the next along a particular dimension. (We’ll cover strides in more detail in a later chapter).</li> </ol> <h3 id="creating-and-using-dimlist"> <a href="#creating-and-using-dimlist" class="anchor-heading" aria-labelledby="creating-and-using-dimlist"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating and Using <code class="language-plaintext highlighter-rouge">DimList</code> </h3> <p>Let’s see how to create and use <code class="language-plaintext highlighter-rouge">DimList</code>. The code for <code class="language-plaintext highlighter-rouge">DimList</code> is also in <code class="language-plaintext highlighter-rouge">stdlib/src/buffer/dimlist.mojo</code>.</p><pre><code class="language-mojo">// from buffer import Dim, DimList // Assuming imports

// --- Creating DimLists ---

// For a 2D shape like 3 rows, 4 columns (all static)
let static_shape_A = DimList(3, 4)
print("Static Shape A:", static_shape_A) // Output: Static Shape A: [3, 4]

// You can also be explicit with Dims
let static_shape_B = DimList(Dim(3), Dim(4))
print("Static Shape B:", static_shape_B) // Output: Static Shape B: [3, 4]

// For a 3D shape: 10 depth, dynamic height, 5 width
let mixed_shape = DimList(10, Dim(), 5)
print("Mixed Shape:", mixed_shape) // Output: Mixed Shape: [10, ?, 5]

// For a 2D shape where both dimensions are dynamic.
// Let's say the rank (number of dimensions) is 2.
let dynamic_shape_rank2 = DimList.create_unknown[2]()
print("Dynamic Shape (Rank 2):", dynamic_shape_rank2) // Output: Dynamic Shape (Rank 2): [?, ?]

// --- Using DimLists ---

// Getting the length (number of dimensions, or rank)
print("Rank of static_shape_A:", len(static_shape_A)) // Output: Rank of static_shape_A: 2
print("Rank of mixed_shape:", len(mixed_shape))       // Output: Rank of mixed_shape: 3

// Accessing a specific Dim at an index (0-based)
let first_dim_of_mixed = mixed_shape.at[0]()
print("First Dim of mixed_shape:", first_dim_of_mixed) // Output: First Dim of mixed_shape: 10

let second_dim_of_mixed = mixed_shape.at[1]()
print("Second Dim of mixed_shape:", second_dim_of_mixed) // Output: Second Dim of mixed_shape: ?

// Checking if a Dim at an index has a static value
print("Is 1st dim of mixed_shape static?", mixed_shape.has_value[0]()) // Output: true
print("Is 2nd dim of mixed_shape static?", mixed_shape.has_value[1]()) // Output: false

// Getting the static value of a Dim at an index (if it's static)
if mixed_shape.has_value[0]():
    print("Value of 1st dim of mixed_shape:", mixed_shape.get[0]()) // Output: 10

// Checking if ALL dimensions in a DimList are statically known
if static_shape_A.all_known[len(static_shape_A)](): // or simply static_shape_A.all_known() in newer Mojo
    print("static_shape_A has all known dimensions.") // This will print

if mixed_shape.all_known[len(mixed_shape)]():
    print("mixed_shape has all known dimensions.")
else:
    print("mixed_shape has at least one dynamic dimension.") // This will print

// Calculating the product of dimensions (e.g., total number of elements)
let product_static = static_shape_A.product()
print("Product of static_shape_A:", product_static) // Output: Product of static_shape_A: 12 (Dim(12))
if product_static:
    print("Value:", product_static.get()) // Output: Value: 12


let product_mixed = mixed_shape.product()
print("Product of mixed_shape:", product_mixed) // Output: Product of mixed_shape: ? (Dim())
if product_mixed.is_dynamic():
    print("Product is dynamic because at least one dimension was dynamic.")
</code></pre><p><strong>Key <code class="language-plaintext highlighter-rouge">DimList</code> features to remember:</strong></p> <ul> <li><strong>Stores <code class="language-plaintext highlighter-rouge">Dim</code>s</strong>: It’s a specialized list for holding dimension information.</li> <li><strong>Static &amp; Dynamic Mix</strong>: Can hold any combination of static and dynamic <code class="language-plaintext highlighter-rouge">Dim</code>s.</li> <li><code class="language-plaintext highlighter-rouge">DimList.create_unknown[RANK]()</code>: A handy way to make a <code class="language-plaintext highlighter-rouge">DimList</code> where all dimensions are dynamic for a given <code class="language-plaintext highlighter-rouge">RANK</code>.</li> <li><code class="language-plaintext highlighter-rouge">at[INDEX]()</code>: Gets the <code class="language-plaintext highlighter-rouge">Dim</code> object at a specific index.</li> <li><code class="language-plaintext highlighter-rouge">get[INDEX]()</code>: Gets the <em>value</em> of the <code class="language-plaintext highlighter-rouge">Dim</code> at that index (if static).</li> <li><code class="language-plaintext highlighter-rouge">product()</code>: Computes the product of all dimensions. If any <code class="language-plaintext highlighter-rouge">Dim</code> in the list is dynamic, the resulting product <code class="language-plaintext highlighter-rouge">Dim</code> will also be dynamic (represented as <code class="language-plaintext highlighter-rouge">?</code>).</li> </ul> <h2 id="dimlist-in-action-ndbuffers-shape-and-strides"> <a href="#dimlist-in-action-ndbuffers-shape-and-strides" class="anchor-heading" aria-labelledby="dimlist-in-action-ndbuffers-shape-and-strides"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">DimList</code> in Action: <code class="language-plaintext highlighter-rouge">NDBuffer</code>’s Shape and Strides </h2> <p>Now, let’s see how <code class="language-plaintext highlighter-rouge">DimList</code> and <code class="language-plaintext highlighter-rouge">Dim</code> are fundamental to <code class="language-plaintext highlighter-rouge">NDBuffer</code>. If we look at the definition of <code class="language-plaintext highlighter-rouge">NDBuffer</code> in <code class="language-plaintext highlighter-rouge">stdlib/src/buffer/buffer.mojo</code> (simplified):</p><pre><code class="language-mojo">// Simplified NDBuffer definition from stdlib/src/buffer/buffer.mojo
struct NDBuffer[
    mut: Bool,
    type: DType,
    rank: Int,
    origin: Origin[mut],
    // Here they are!
    shape: DimList = DimList.create_unknown[rank](),
    strides: DimList = DimList.create_unknown[rank](),
    *,
    // ... other parameters ...
]{
    var data: UnsafePointer[...];
    var dynamic_shape: IndexList[rank, ...];
    var dynamic_stride: IndexList[rank, ...];
    // ...
}
</code></pre><p>Notice the <code class="language-plaintext highlighter-rouge">shape: DimList</code> and <code class="language-plaintext highlighter-rouge">strides: DimList</code> parameters in the <code class="language-plaintext highlighter-rouge">NDBuffer</code> definition.</p> <ul> <li><code class="language-plaintext highlighter-rouge">shape: DimList</code>: This <code class="language-plaintext highlighter-rouge">DimList</code> tells the <code class="language-plaintext highlighter-rouge">NDBuffer</code> its size in each of its <code class="language-plaintext highlighter-rouge">rank</code> dimensions.</li> <li><code class="language-plaintext highlighter-rouge">strides: DimList</code>: This <code class="language-plaintext highlighter-rouge">DimList</code> tells the <code class="language-plaintext highlighter-rouge">NDBuffer</code> how to navigate its data in memory. (More on this in a future chapter!)</li> </ul> <p>By default, if you don’t specify them, <code class="language-plaintext highlighter-rouge">shape</code> and <code class="language-plaintext highlighter-rouge">strides</code> are <code class="language-plaintext highlighter-rouge">DimList.create_unknown[rank]()</code>, meaning all dimensions and strides are initially considered dynamic.</p> <p>When you create or work with an <code class="language-plaintext highlighter-rouge">NDBuffer</code>, you might provide these <code class="language-plaintext highlighter-rouge">DimList</code>s:</p> <ul> <li>If <code class="language-plaintext highlighter-rouge">shape</code> has all static <code class="language-plaintext highlighter-rouge">Dim</code>s (e.g., <code class="language-plaintext highlighter-rouge">DimList(100, 200)</code> for a 2D buffer), Mojo knows the exact size of the buffer at compile time.</li> <li>If <code class="language-plaintext highlighter-rouge">shape</code> has some dynamic <code class="language-plaintext highlighter-rouge">Dim</code>s (e.g., <code class="language-plaintext highlighter-rouge">DimList(Dim(100), Dim())</code>), Mojo knows some dimensions statically and will figure out others at runtime. The actual runtime values for dynamic dimensions are stored in fields like <code class="language-plaintext highlighter-rouge">dynamic_shape</code> inside the <code class="language-plaintext highlighter-rouge">NDBuffer</code>.</li> </ul> <h2 id="why-static-vs-dynamic-matters-so-much"> <a href="#why-static-vs-dynamic-matters-so-much" class="anchor-heading" aria-labelledby="why-static-vs-dynamic-matters-so-much"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why Static vs. Dynamic Matters So Much </h2> <p>This ability to mix static and dynamic dimensions is a superpower of Mojo:</p> <ol> <li><strong>Flexibility</strong>: You can write code that works with data of varying sizes, where those sizes aren’t known until your program runs. This is essential for real-world applications.</li> <li><strong>Performance</strong>: When dimension sizes <em>are</em> known statically (at compile time), Mojo can perform powerful optimizations. It can unroll loops, pre-calculate memory offsets, and generate highly specialized machine code. This often leads to significantly faster execution compared to situations where all sizes are only known dynamically.</li> </ol> <p><code class="language-plaintext highlighter-rouge">Dim</code> and <code class="language-plaintext highlighter-rouge">DimList</code> are the mechanisms that allow Mojo developers to communicate this static-or-dynamic information to the compiler, enabling this blend of flexibility and performance.</p> <h2 id="key-takeaways-for-chapter-2"> <a href="#key-takeaways-for-chapter-2" class="anchor-heading" aria-labelledby="key-takeaways-for-chapter-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Takeaways for Chapter 2 </h2> <ul> <li>A <code class="language-plaintext highlighter-rouge">Dim</code> represents a single dimension’s size, which can be <strong>statically known</strong> (a fixed number) or <strong>dynamic</strong> (unknown until runtime, represented as <code class="language-plaintext highlighter-rouge">?</code>).</li> <li><code class="language-plaintext highlighter-rouge">DimList</code> is a list of <code class="language-plaintext highlighter-rouge">Dim</code>s, used by <code class="language-plaintext highlighter-rouge">NDBuffer</code> to define its <code class="language-plaintext highlighter-rouge">shape</code> (size in each dimension) and <code class="language-plaintext highlighter-rouge">strides</code> (memory layout).</li> <li>You can create <code class="language-plaintext highlighter-rouge">DimList</code>s with all static dimensions (<code class="language-plaintext highlighter-rouge">DimList(2,3,4)</code>), all dynamic dimensions (<code class="language-plaintext highlighter-rouge">DimList.create_unknown[3]()</code>), or a mix (<code class="language-plaintext highlighter-rouge">DimList(2, Dim(), 4)</code>).</li> <li>If any <code class="language-plaintext highlighter-rouge">Dim</code> in a <code class="language-plaintext highlighter-rouge">DimList</code> is dynamic, operations like <code class="language-plaintext highlighter-rouge">product()</code> on that <code class="language-plaintext highlighter-rouge">DimList</code> will result in a dynamic <code class="language-plaintext highlighter-rouge">Dim</code> (<code class="language-plaintext highlighter-rouge">?</code>).</li> <li>This static/dynamic system allows <code class="language-plaintext highlighter-rouge">NDBuffer</code> (and Mojo in general) to be both <strong>flexible</strong> (handling runtime-determined sizes) and <strong>performant</strong> (optimizing heavily when sizes are compile-time known).</li> </ul> <h2 id="whats-next"> <a href="#whats-next" class="anchor-heading" aria-labelledby="whats-next"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What’s Next? </h2> <p>We’ve now seen how <code class="language-plaintext highlighter-rouge">NDBuffer</code> knows <em>where</em> its data starts (<code class="language-plaintext highlighter-rouge">UnsafePointer</code>) and how it understands the <em>intended structure</em> of that data (<code class="language-plaintext highlighter-rouge">DimList</code> for shape). In the next chapter, <a href="03_ndbuffer_.md">Chapter 3: NDBuffer</a>, we’ll take a closer look at the <code class="language-plaintext highlighter-rouge">NDBuffer</code> struct itself, how it’s initialized with these components, and how you start actually using it to access and manipulate N-dimensional data.</p><hr /> <p><em>Navigation</em></p> <ol> <li><a href="01_unsafepointer__as_used_by_ndbuffer__.md">UnsafePointer (as used by NDBuffer)</a></li> <li><strong>DimList and Dim (You are here)</strong></li> <li><a href="03_ndbuffer_.md">NDBuffer</a></li> <li><a href="04_strides_and_offset_computation_.md">Strides and Offset Computation</a></li> <li><a href="05_simd_data_access_.md">SIMD Data Access</a> ```</li> </ol><hr /> <p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a></p> </main> </div> </div> <div class="search-overlay"></div> </div> <script type="module"> import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.esm.min.mjs'; var config = {} ; mermaid.initialize(config); mermaid.run({ querySelector: '.language-mermaid', }); </script> </body> </html>
